<div class="main-container-two pt-4">
  <div class="card-event shadow">
    <%= cl_image_tag(@event.photo) %>
    <div class="card-event-infos">
      <div>
        <h2 class="card-event-date">29 Nov</h2>
        <p>FRIDAY</p>
      </div>
      <div class="event-details">
        <h2><%= @event.name %></h2>
      </div>
      <img src="<%= @event.organizer.photo %>" class="card-event-user avatar-bordered" />
    </div>
  </div>
  <div class="container shadow mt-2 bg-white d-flex" style="padding-left: 0;">
    <div
      id="map"
      style="width: 50%;
      height: 250px; margin-left: 0;"
      data-marker="<%= @marker.to_json %>"
      data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>"></div>
    <div class="text-center w-50">
      <div class="d-flex asd align-items-center justify-content-center">
        <div class="event-time mt-5 mb-4">
          <p class="p-1"><%= @event.time %></p>
        </div>
          <p><%= @event.address %></p>
        </div>
      </div>
  </div>
  <br>
<div class="voters">
  <table id="body-table" style="width:100%">
  <tr>
    <th></th>
    <% @event.event_dates.each do |event_date| %>
      <th><h5><%= Date::ABBR_MONTHNAMES[event_date.date.month] %></h5><h3><%= event_date.date.day  %></h3><p><%= Date::ABBR_DAYNAMES[event_date.date.wday] %></p></th>
    <% end %>
  </tr>
  <tr id="current_user_row">
    <td><img src="<%= current_user.photo %>" class="avatar photos" alt=""> <%= current_user.name %></td>
    <% @event.event_dates.each do |event_date| %>
      <td id="vote_button_<%= event_date.id %>"><%= render 'votes/vote_button', event_date: event_date %></td>
    <% end %>
  </tr>
  <% @event.group.users.reject {|u| u == current_user }.each_with_index do |user, index| %>
  <tr class="<%= index.even? ? "grey" : "white" %>">
    <td class="user_photo_name"><img src="<%= user.photo %>" class="avatar photos" alt=""> <%= user.name %></td>
    <% @event.event_dates.each do |event_date| %>
      <% if Vote.find_by(user: user, event_date: event_date) %>
        <td><i class="fas fa-check-circle text-warning"></i></td>
      <% else %>
        <td><i class="fas fa-check-circle" style="color: #dedede"></i></td>
      <% end %>
    <% end %>
  </tr>
  <% end %>
  <tr class="count">
    <td>Attendants</td>
    <% @event.event_dates.each do |event_date| %>
      <td><%= event_date.votes.count %></td>
    <% end %>
  </tr>
</table>
</div>

  <div class="buttons">
    <% if @event.organizer == current_user %>
      <%= link_to "Edit", edit_group_event_path(@event.group, @event), class: "secondary-button" %>
      <%= link_to "Delete", group_event_path(@event.group, @event), method: :delete, data: { confirm: "Are you sure?" }, class: "secondary-button" %>
    <% end %>
  </div>
  <%= link_to "Back to groups", group_path(@event.group), class: "secondary-button", style: "padding: 10px" %>
</div>

